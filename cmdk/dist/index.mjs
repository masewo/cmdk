import{a as le}from"./chunk-NZJY6EH4.mjs";import*as w from"@radix-ui/react-dialog";import*as t from"react";import{Primitive as M}from"@radix-ui/react-primitive";import{useId as L}from"@radix-ui/react-id";import Re from"react-textarea-autosize";var G='[cmdk-group=""]',Z='[cmdk-group-items=""]',be='[cmdk-group-heading=""]',F='[cmdk-item=""]',ue=`${F}:not([aria-disabled="true"])`,ee="cmdk-item-select",T="data-value",he=(n,o,r)=>le(n,o,r),de=t.createContext(void 0),A=()=>t.useContext(de),fe=t.createContext(void 0),j=()=>t.useContext(fe),me=t.createContext(void 0);var ve=t.forwardRef((n,o)=>{let r=D(()=>{var e,c;return{search:"",value:(c=(e=n.value)!=null?e:n.defaultValue)!=null?c:"",filtered:{count:0,items:new Map,groups:new Set}}}),d=D(()=>new Set),l=D(()=>new Map),u=D(()=>new Map),f=D(()=>new Set),p=pe(n),{label:m,children:b,value:s,onValueChange:h,filter:E,shouldFilter:x,loop:H,disablePointerSelection:te=!1,vimBindings:q=!0,...O}=n,ne=L(),U=L(),K=L(),P=t.useRef(null),R=ke();k(()=>{if(s!==void 0){let e=s.trim();r.current.value=e,y.emit()}},[s]),k(()=>{R(6,oe)},[]);let y=t.useMemo(()=>({subscribe:e=>(f.current.add(e),()=>f.current.delete(e)),snapshot:()=>r.current,setState:(e,c,a)=>{var i,v,g;if(!Object.is(r.current[e],c)){if(r.current[e]=c,e==="search")X(),W(),R(1,J);else if(e==="value"&&(a||R(5,oe),((i=p.current)==null?void 0:i.value)!==void 0)){let C=c!=null?c:"";(g=(v=p.current).onValueChange)==null||g.call(v,C);return}y.emit()}},emit:()=>{f.current.forEach(e=>e())}}),[]),z=t.useMemo(()=>({value:(e,c,a)=>{var i;c!==((i=u.current.get(e))==null?void 0:i.value)&&(u.current.set(e,{value:c,keywords:a}),r.current.filtered.items.set(e,re(c,a)),R(2,()=>{W(),y.emit()}))},item:(e,c)=>(d.current.add(e),c&&(l.current.has(c)?l.current.get(c).add(e):l.current.set(c,new Set([e]))),R(3,()=>{X(),W(),r.current.value||J(),y.emit()}),()=>{u.current.delete(e),d.current.delete(e),r.current.filtered.items.delete(e);let a=_();R(4,()=>{X(),(a==null?void 0:a.getAttribute("id"))===e&&J(),y.emit()})}),group:e=>(l.current.has(e)||l.current.set(e,new Set),()=>{u.current.delete(e),l.current.delete(e)}),filter:()=>p.current.shouldFilter,label:m||n["aria-label"],disablePointerSelection:te,listId:ne,inputId:K,labelId:U,listInnerRef:P}),[]);function re(e,c){var i,v;let a=(v=(i=p.current)==null?void 0:i.filter)!=null?v:he;return e?a(e,r.current.search,c):0}function W(){if(!r.current.search||p.current.shouldFilter===!1)return;let e=r.current.filtered.items,c=[];r.current.filtered.groups.forEach(i=>{let v=l.current.get(i),g=0;v.forEach(C=>{let I=e.get(C);g=Math.max(I,g)}),c.push([i,g])});let a=P.current;V().sort((i,v)=>{var I,N;let g=i.getAttribute("id"),C=v.getAttribute("id");return((I=e.get(C))!=null?I:0)-((N=e.get(g))!=null?N:0)}).forEach(i=>{let v=i.closest(Z);v?v.appendChild(i.parentElement===v?i:i.closest(`${Z} > *`)):a.appendChild(i.parentElement===a?i:i.closest(`${Z} > *`))}),c.sort((i,v)=>v[1]-i[1]).forEach(i=>{var g;let v=(g=P.current)==null?void 0:g.querySelector(`${G}[${T}="${encodeURIComponent(i[0])}"]`);v==null||v.parentElement.appendChild(v)})}function J(){let e=V().find(a=>a.getAttribute("aria-disabled")!=="true"),c=e==null?void 0:e.getAttribute(T);y.setState("value",c||void 0)}function X(){var c,a,i,v;if(!r.current.search||p.current.shouldFilter===!1){r.current.filtered.count=d.current.size;return}r.current.filtered.groups=new Set;let e=0;for(let g of d.current){let C=(a=(c=u.current.get(g))==null?void 0:c.value)!=null?a:"",I=(v=(i=u.current.get(g))==null?void 0:i.keywords)!=null?v:[],N=re(C,I);r.current.filtered.items.set(g,N),N>0&&e++}for(let[g,C]of l.current)for(let I of C)if(r.current.filtered.items.get(I)>0){r.current.filtered.groups.add(g);break}r.current.filtered.count=e}function oe(){var c,a,i;let e=_();e&&(((c=e.parentElement)==null?void 0:c.firstChild)===e&&((i=(a=e.closest(G))==null?void 0:a.querySelector(be))==null||i.scrollIntoView({block:"nearest"})),e.scrollIntoView({block:"nearest"}))}function _(){var e;return(e=P.current)==null?void 0:e.querySelector(`${F}[aria-selected="true"]`)}function V(){var e;return Array.from(((e=P.current)==null?void 0:e.querySelectorAll(ue))||[])}function Q(e){let a=V()[e];a&&y.setState("value",a.getAttribute(T))}function Y(e){var g;let c=_(),a=V(),i=a.findIndex(C=>C===c),v=a[i+e];(g=p.current)!=null&&g.loop&&(v=i+e<0?a[a.length-1]:i+e===a.length?a[0]:a[i+e]),v&&y.setState("value",v.getAttribute(T))}function ae(e){let c=_(),a=c==null?void 0:c.closest(G),i;for(;a&&!i;)a=e>0?we(a,G):Me(a,G),i=a==null?void 0:a.querySelector(ue);i?y.setState("value",i.getAttribute(T)):Y(e)}let ie=()=>Q(V().length-1),se=e=>{e.preventDefault(),e.metaKey?ie():e.altKey?ae(1):Y(1)},ce=e=>{e.preventDefault(),e.metaKey?Q(0):e.altKey?ae(-1):Y(-1)};return t.createElement(M.div,{ref:o,tabIndex:-1,...O,"cmdk-root":"",onKeyDown:e=>{var c;if((c=O.onKeyDown)==null||c.call(O,e),!e.defaultPrevented)switch(e.key){case"n":case"j":{q&&e.ctrlKey&&se(e);break}case"ArrowDown":{se(e);break}case"p":case"k":{q&&e.ctrlKey&&ce(e);break}case"ArrowUp":{ce(e);break}case"Home":{e.preventDefault(),Q(0);break}case"End":{e.preventDefault(),ie();break}case"Enter":if(!e.nativeEvent.isComposing&&e.keyCode!==229){e.preventDefault();let a=_();if(a){let i=new Event(ee);a.dispatchEvent(i)}}}}},t.createElement("label",{"cmdk-label":"",htmlFor:z.inputId,id:z.labelId,style:Le},m),B(n,e=>t.createElement(fe.Provider,{value:y},t.createElement(de.Provider,{value:z},e))))}),ye=t.forwardRef((n,o)=>{var K,P;let r=L(),d=t.useRef(null),l=t.useContext(me),u=A(),f=pe(n),p=(P=(K=f.current)==null?void 0:K.forceMount)!=null?P:l==null?void 0:l.forceMount;k(()=>{if(!p)return u.item(r,l==null?void 0:l.id)},[p]);let m=ge(r,d,[n.value,n.children,d],n.keywords),b=j(),s=S(R=>R.value&&R.value===m.current),h=S(R=>p||u.filter()===!1?!0:R.search?R.filtered.items.get(r)>0:!0);t.useEffect(()=>{let R=d.current;if(!(!R||n.disabled))return R.addEventListener(ee,E),()=>R.removeEventListener(ee,E)},[h,n.onSelect,n.disabled]);function E(){var R,y;x(),(y=(R=f.current).onSelect)==null||y.call(R,m.current)}function x(){b.setState("value",m.current,!0)}if(!h)return null;let{disabled:H,value:te,onSelect:q,forceMount:O,keywords:ne,...U}=n;return t.createElement(M.div,{ref:$([d,o]),...U,id:r,"cmdk-item":"",role:"option","aria-disabled":!!H,"aria-selected":!!s,"data-disabled":!!H,"data-selected":!!s,onPointerMove:H||u.disablePointerSelection?void 0:x,onClick:H?void 0:E},n.children)}),Ce=t.forwardRef((n,o)=>{let{heading:r,children:d,forceMount:l,...u}=n,f=L(),p=t.useRef(null),m=t.useRef(null),b=L(),s=A(),h=S(x=>l||s.filter()===!1?!0:x.search?x.filtered.groups.has(f):!0);k(()=>s.group(f),[]),ge(f,p,[n.value,n.heading,m]);let E=t.useMemo(()=>({id:f,forceMount:l}),[l]);return t.createElement(M.div,{ref:$([p,o]),...u,"cmdk-group":"",role:"presentation",hidden:h?void 0:!0},r&&t.createElement("div",{ref:m,"cmdk-group-heading":"","aria-hidden":!0,id:b},r),B(n,x=>t.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?b:void 0},t.createElement(me.Provider,{value:E},x))))}),Se=t.forwardRef((n,o)=>{let{alwaysRender:r,...d}=n,l=t.useRef(null),u=S(f=>!f.search);return!r&&!u?null:t.createElement(M.div,{ref:$([l,o]),...d,"cmdk-separator":"",role:"separator"})}),Ee=t.forwardRef((n,o)=>{let{onValueChange:r,...d}=n,l=n.value!=null,u=j(),f=S(s=>s.search),p=S(s=>s.value),m=A(),b=t.useMemo(()=>{var h;let s=(h=m.listInnerRef.current)==null?void 0:h.querySelector(`${F}[${T}="${encodeURIComponent(p)}"]`);return s==null?void 0:s.getAttribute("id")},[]);return t.useEffect(()=>{n.value!=null&&u.setState("search",n.value)},[n.value]),t.createElement(M.input,{ref:o,...d,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":m.listId,"aria-labelledby":m.labelId,"aria-activedescendant":b,id:m.inputId,type:"text",value:l?n.value:f,onChange:s=>{l||u.setState("search",s.target.value),r==null||r(s.target.value)}})}),Ve=t.forwardRef((n,o)=>{let{onValueChange:r,...d}=n,l=n.value!=null,u=j(),f=S(s=>s.search),p=S(s=>s.value),m=A(),b=t.useMemo(()=>{var h;let s=(h=m.listInnerRef.current)==null?void 0:h.querySelector(`${F}[${T}="${encodeURIComponent(p)}"]`);return s==null?void 0:s.getAttribute("id")},[]);return t.useEffect(()=>{n.value!=null&&u.setState("search",n.value)},[n.value]),t.createElement(Re,{ref:o,...d,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":m.listId,"aria-labelledby":m.labelId,"aria-activedescendant":b,id:m.inputId,value:l?n.value:f,onChange:s=>{l||u.setState("search",s.target.value),r==null||r(s.target.value)}})}),xe=t.forwardRef((n,o)=>{let{children:r,label:d="Suggestions",...l}=n,u=t.useRef(null),f=t.useRef(null),p=A();return t.useEffect(()=>{if(f.current&&u.current){let m=f.current,b=u.current,s,h=new ResizeObserver(()=>{s=requestAnimationFrame(()=>{let E=m.offsetHeight;b.style.setProperty("--cmdk-list-height",E.toFixed(1)+"px")})});return h.observe(m),()=>{cancelAnimationFrame(s),h.unobserve(m)}}},[]),t.createElement(M.div,{ref:$([u,o]),...l,"cmdk-list":"",role:"listbox","aria-label":d,id:p.listId},B(n,m=>t.createElement("div",{ref:$([f,p.listInnerRef]),"cmdk-list-sizer":""},m)))}),Pe=t.forwardRef((n,o)=>{let{open:r,onOpenChange:d,overlayClassName:l,contentClassName:u,container:f,...p}=n;return t.createElement(w.Root,{open:r,onOpenChange:d},t.createElement(w.Portal,{container:f},t.createElement(w.Overlay,{"cmdk-overlay":"",className:l}),t.createElement(w.Content,{"aria-label":n.label,"cmdk-dialog":"",className:u},t.createElement(ve,{ref:o,...p}))))}),Ie=t.forwardRef((n,o)=>S(d=>d.filtered.count===0)?t.createElement(M.div,{ref:o,...n,"cmdk-empty":"",role:"presentation"}):null),Te=t.forwardRef((n,o)=>{let{progress:r,children:d,label:l="Loading...",...u}=n;return t.createElement(M.div,{ref:o,...u,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":l},B(n,f=>t.createElement("div",{"aria-hidden":!0},f)))}),Ne=Object.assign(ve,{List:xe,Item:ye,Input:Ee,Group:Ce,Separator:Se,Dialog:Pe,Empty:Ie,Loading:Te});function we(n,o){let r=n.nextElementSibling;for(;r;){if(r.matches(o))return r;r=r.nextElementSibling}}function Me(n,o){let r=n.previousElementSibling;for(;r;){if(r.matches(o))return r;r=r.previousElementSibling}}function pe(n){let o=t.useRef(n);return k(()=>{o.current=n}),o}var k=typeof window=="undefined"?t.useEffect:t.useLayoutEffect;function D(n){let o=t.useRef();return o.current===void 0&&(o.current=n()),o}function $(n){return o=>{n.forEach(r=>{typeof r=="function"?r(o):r!=null&&(r.current=o)})}}function S(n){let o=j(),r=()=>n(o.snapshot());return t.useSyncExternalStore(o.subscribe,r,r)}function ge(n,o,r,d=[]){let l=t.useRef(),u=A();return k(()=>{var m;let f=(()=>{var b;for(let s of r){if(typeof s=="string")return s.trim();if(typeof s=="object"&&"current"in s)return s.current?(b=s.current.textContent)==null?void 0:b.trim():l.current}})(),p=d.map(b=>b.trim());u.value(n,f,p),(m=o.current)==null||m.setAttribute(T,f),l.current=f}),l}var ke=()=>{let[n,o]=t.useState(),r=D(()=>new Map);return k(()=>{r.current.forEach(d=>d()),r.current=new Map},[n]),(d,l)=>{r.current.set(d,l),o({})}};function De(n){let o=n.type;return typeof o=="function"?o(n.props):"render"in o?o.render(n.props):n}function B({asChild:n,children:o},r){return n&&t.isValidElement(o)?t.cloneElement(De(o),{ref:o.ref},r(o.props.children)):r(o)}var Le={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};export{Ne as Command,Pe as CommandDialog,Ie as CommandEmpty,Ce as CommandGroup,Ee as CommandInput,ye as CommandItem,xe as CommandList,Te as CommandLoading,ve as CommandRoot,Se as CommandSeparator,he as defaultFilter,S as useCommandState};
